{"version":3,"sources":["carbon.js"],"names":[],"mappings":"CACA,SAAA,GACA,YAIA,SAAA,KACA,OACA,cACA,KAAA,SAAA,GAAA,MAAA,MAAA,WAAA,IAAA,QACA,KAAA,SAAA,EAAA,GAAA,MAAA,MAAA,WAAA,GAAA,GACA,MAAA,SAAA,EAAA,GACA,IAAA,GAAA,KAAA,MAAA,WACA,GAAA,IAAA,EAAA,QAAA,GACA,MAAA,WAAA,EAAA,MAAA,GAAA,GACA,KAAA,EAAA,GAAA,MAAA,WAAA,GAAA,KAAA,WAAA,GAEA,kBAAA,MAAA,WAAA,GAAA,GAAA,MAAA,WAAA,GAAA,KAAA,WAAA,IAKA,iBAAA,SAAA,GACA,GAAA,gBAAA,GAAA,CACA,GAAA,KAAA,EAAA,QAAA,KAAA,CACA,GAAA,GAAA,EAAA,MAAA,KAAA,GAAA,EAAA,EAAA,MAAA,KAAA,EACA,OAAA,GAAA,SAAA,GAAA,MAAA,GAEA,MAAA,MAAA,MAAA,GAGA,MAAA,IAGA,iBAAA,SAAA,GACA,OAAA,QAAA,OAAA,EAAA,IAAA,KAAA,iBAAA,QAEA,QAAA,SAAA,EAAA,GACA,GAEA,GAAA,EAFA,EAAA,EAAA,UACA,EAAA,UAAA,OAAA,EAAA,EAAA,KAAA,UAAA,EAAA,UAAA,QAAA,IAOA,IADA,EAAA,KAAA,KAAA,GACA,SAAA,GAAA,IAAA,UAAA,OAEA,MADA,GAAA,EACA,GAAA,EACA,IAAA,SAAA,GAAA,UAAA,OAAA,EACA,KAAA,IAAA,OAAA,WAAA,EAAA,mBAiBA,OAVA,GAAA,EAAA,EAAA,KAAA,MAAA,EAAA,KAAA,iBAAA,IAAA,EAKA,KAAA,KAAA,EAAA,GAKA,MAEA,QAAA,SAAA,EAAA,GACA,GAAA,GAAA,EAAA,EAAA,UAAA,EAAA,UAAA,OAAA,EAAA,EAAA,KAAA,UAAA,EAAA,UAAA,QAAA,IAMA,IADA,EAAA,KAAA,KAAA,GACA,SAAA,GAAA,IAAA,UAAA,OACA,MAAA,kBAAA,GAAA,KAAA,KAAA,EAAA,GAAA,IAAA,CACA,IAAA,SAAA,GAAA,UAAA,OAAA,EACA,KAAA,IAAA,OAAA,WAAA,EAAA,mBAgBA,OAVA,GAAA,EAAA,EAAA,KAAA,MAAA,EAAA,KAAA,iBAAA,IAAA,EAKA,KAAA,KAAA,EAAA,GAKA,OA3FA,GAAA,GAAA,MAAA,UAAA,MAgGA,GACA,YACA,kBAAA,SAAA,EAAA,GAGA,IAAA,GAAA,KAAA,GAIA,GAAA,gBAAA,GAAA,GAAA,CAQA,GAEA,GAFA,EAAA,EAAA,GAAA,MAAA,KAAA,GACA,EAAA,EAAA,GAAA,MAAA,KAAA,EAMA,GAAA,EAAA,SAAA,GAKA,EAAA,KAAA,EAAA,MAAA,GAAA,GAAA,QAnBA,GAAA,KAAA,EAAA,KAsBA,OAAA,SAAA,GACA,GAAA,GAAA,CAEA,OAAA,MAAA,SAAA,GACA,KAAA,SAAA,IAMA,EAAA,GAAA,GACA,EAAA,OAAA,OAAA,GAEA,EAAA,MAAA,EAKA,EAAA,KAAA,SAAA,GAAA,IAEA,KAAA,SAAA,GACA,GAAA,GAAA,UAAA,OAAA,EAAA,MAAA,UAAA,MAAA,KAAA,UAAA,GAAA,KAAA,GAAA,OAaA,OAXA,KAIA,KAAA,kBAAA,EAAA,GAKA,EAAA,EAAA,KAAA,MAAA,EAAA,IAEA,GAGA,GAAA,OAAA,GACA","file":"carbon.min.js","sourcesContent":["\n(function(exports) {\n    \"use strict\";\n\n    var slice = Array.prototype.slice;\n\n    function ModuleTemplate() {\n        return {\n            _providers: {},\n            _get: function(providerName) { return this._providers[providerName] || undefined; },\n            _set: function(providerName, provider) { return (this._providers[providerName] = provider); },\n            _find: function(name, constructed) {\n                for (var i in this._providers) {\n                    if (i.indexOf(name) === 0) {\n                        if (i.split(name)[1] == 'Factory') {\n                            return (constructed !== false ? new this._providers[i]() : this._providers[i]);\n                        } else {\n                            return (typeof this._providers[i] === 'function') ? new this._providers[i]() : this._providers[i];\n                        }\n                    }\n                }\n            },\n            _mapDependencies: function(key) {\n                if (typeof key === 'string') {\n                    if (key.indexOf('.') !== -1) {\n                        var mod = key.split('.')[0], provider = key.split('.')[1];\n                        return carbon._modules[mod]._find(provider);\n                    } else {\n                        return this._find(key);\n                    }\n                } else {\n                    return key;\n                }\n            },\n            _getDependencies: function(dependencies) {\n                return [undefined].concat(dependencies.map(this._mapDependencies, this));\n            },\n            factory: function(name, Factory) {\n                var providerName = name + 'Factory',\n                    deps = arguments.length > 2 ? slice.call(arguments, 2, arguments.length) : null,\n                    provider, Service;\n\n                // ----------------------------------------\n                // check if the factory exists\n                // ----------------------------------------\n                provider = this._get(providerName);\n                if (provider !== undefined && arguments.length === 1) {\n                    Service = provider;\n                    return new Service();\n                } else if (provider !== undefined && arguments.length > 1) {\n                    throw new Error('Factory ' + name + ' already exists.');\n                }\n\n                // ----------------------------------------\n                // add any dependencies if they exist\n                // ----------------------------------------\n                // REVIEW:: why does this setup always need the first item to be undefined ? \n                Factory = deps ? Factory.bind.apply(Factory, this._getDependencies(deps)) : Factory;\n\n                // ----------------------------------------\n                // store the factory\n                // ----------------------------------------\n                this._set(providerName, Factory);\n\n                // ----------------------------------------\n                // return the module for chaining\n                // ----------------------------------------\n                return this;\n            },\n            service: function(name, Service) {\n                var providerName = name + 'Service', deps = arguments.length > 2 ? slice.call(arguments, 2, arguments.length) : null, Provider;\n\n                // ----------------------------------------\n                // check if the service exists\n                // ----------------------------------------\n                Provider = this._get(providerName);\n                if (Provider !== undefined && arguments.length === 1) {\n                    return (typeof Provider === 'function' ? this._set(providerName, new Provider()) : Provider);\n                } else if (Provider !== undefined && arguments.length > 1) {\n                    throw new Error('Service ' + name + ' already exists.');\n                }\n\n                // ----------------------------------------\n                // add any dependencies if they exist\n                // ----------------------------------------\n                Service = deps ? Service.bind.apply(Service, this._getDependencies(deps)) : Service;\n\n                // ----------------------------------------\n                // save the service\n                // ----------------------------------------\n                this._set(providerName, Service);\n\n                // ----------------------------------------\n                // return the module for chaining\n                // ----------------------------------------\n                return this;\n            }\n        };\n    }\n\n    var carbon = {\n        _modules: {},\n        _map_dependencies: function(container, dependencies) {\n            var injectables, objs;\n\n            for (var i in dependencies) {\n                // ----------------------------------------\n                // if i is an object/function, add it directly.\n                // ----------------------------------------\n                if (typeof dependencies[i] !== 'string') {\n                    container.push(dependencies[i]);\n                    continue;\n                }\n\n                // ----------------------------------------\n                // Get the injectable from the module we are importing from\n                // ----------------------------------------\n                var mod = dependencies[i].split('.')[0],\n                    provider = dependencies[i].split('.')[1],\n                    module;\n\n                // ----------------------------------------\n                // get the module\n                // ----------------------------------------\n                module = carbon._modules[mod];\n\n                // ----------------------------------------\n                // use the module to try and load the provider\n                // ----------------------------------------\n                container.push(module._find(provider, false, true));\n            }\n        },\n        module: function(name) {\n            var mt, instance;\n\n            if (this._modules[name]) {\n                return this._modules[name];\n            }\n\n            // ----------------------------------------\n            // create new instance\n            // ----------------------------------------\n            mt = new ModuleTemplate();\n            instance = Object.create(mt);\n\n            instance._name = name;\n\n            // ----------------------------------------\n            // save the instances and return it\n            // ----------------------------------------\n            return instance = this._modules[name] = instance;\n        },\n        wrap: function(fn) {\n            var deps = arguments.length > 1 ? Array.prototype.slice.call(arguments, 1) : null, container = [undefined];\n\n            if (deps) {\n                // ----------------------------------------\n                // map to the modules, and retrieve them from it's providers\n                // ----------------------------------------\n                this._map_dependencies(container, deps);\n\n                // ----------------------------------------\n                // wrap a function to enable di of module dependencies.\n                // ----------------------------------------\n                fn = fn.bind.apply(fn, container);\n            }\n            return fn;            \n        }\n    };\n    exports.carbon = carbon;\n})(this);\n"],"sourceRoot":"/source/"}